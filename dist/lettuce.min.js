/*! lettuce 05-01-2015 */
!function(a){"use strict";function b(){this._callbacks=[]}function c(a,d){var e=new b;return 0===a.length?e.done.apply(e,d):a[0].apply(null,d).then(function(){a.splice(0,1),c(a,arguments).then(function(){e.done.apply(e,arguments)})}),e}function d(a){var b;return b=this instanceof d?this:g(d.prototype),b["class"]=d,b["super"]=a.prototype,b}var e=function(){};e.VERSION="0.0.1",a.lettuce=e,e.isObject=function(a){var b=typeof a;return"function"===b||"object"===b&&!!a},e.extend=function(a){if(!e.isObject(a))return a;for(var b,c,d=1,f=arguments.length;f>d;d++){b=arguments[d];for(c in b)hasOwnProperty.call(b,c)&&(a[c]=b[c])}return a},b.prototype.then=function(a,c){var d;return this._isdone?d=a.apply(c,this.result):(d=new b,this._callbacks.push(function(){var b=a.apply(c,arguments);b&&"function"==typeof b.then&&b.then(d.done,d)})),d},b.prototype.done=function(){this.result=arguments,this._isdone=!0;for(var a=0;a<this._callbacks.length;a++)this._callbacks[a].apply(null,arguments);this._callbacks=[]};var f={Promise:b,chain:c};e.prototype=e.extend(e.prototype,f);var g;g="function"==typeof Object.create?Object.create:function(a){function b(){}return b.prototype=a,new b},e.prototype.Class=d;var h=function(a,b){var c=/[^\w\-\.:]/.test(a)?new Function(h.arg+",tmpl","var _e=tmpl.encode"+h.helper+",_s='"+a.replace(h.regexp,h.func)+"';return _s;"):h.cache[a]=h.cache[a]||h(h.load(a));return b?c(b,h):function(a){return c(a,h)}};h.cache={},h.load=function(a){return document.getElementById(a).innerHTML},h.regexp=/([\s'\\])(?!(?:[^{]|\{(?!%))*%\})|(?:\{%(=|#)([\s\S]+?)%\})|(\{%)|(%\})/g,h.func=function(a,b,c,d,e,f){return b?{"\n":"\\n","\r":"\\r","	":"\\t"," ":" "}[b]||"\\"+b:c?"="===c?"'+_e("+d+")+'":"'+("+d+"==null?'':"+d+")+'":e?"';":f?"_s+='":void 0},h.encReg=/[<>&"'\x00]/g,h.encMap={"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;","'":"&#39;"},h.encode=function(a){return(null==a?"":""+a).replace(h.encReg,function(a){return h.encMap[a]||""})},h.arg="o",h.helper=",print=function(s,e){_s+=e?(s==null?'':s):_e(s);},include=function(s,d){_s+=tmpl(s,d);}",e.prototype.tmpl=h;var i={routes:[],mode:null,root:"/",config:function(a){return this.mode=a&&a.mode&&"history"==a.mode&&history.pushState?"history":"hash",this.root=a&&a.root?"/"+this.clearSlashes(a.root)+"/":"/",this},getFragment:function(){var a="";if("history"===this.mode)a=this.clearSlashes(decodeURI(location.pathname+location.search)),a=a.replace(/\?(.*)$/,""),a="/"!=this.root?a.replace(this.root,""):a;else{var b=window.location.href.match(/#(.*)$/);a=b?b[1]:""}return this.clearSlashes(a)},clearSlashes:function(a){return a.toString().replace(/\/$/,"").replace(/^\//,"")},add:function(a,b){return"function"==typeof a&&(b=a,a=""),this.routes.push({re:a,handler:b}),this},remove:function(a){for(var b=0,c=this.routes[b];b<this.routes.length;b++)if(c.handler===a||c.re.toString()===a.toString())return this.routes.splice(b,1),this;return this},flush:function(){return this.routes=[],this.mode=null,this.root="/",this},check:function(a){for(var b=a||this.getFragment(),c=0;c<this.routes.length;c++){var d=b.match(this.routes[c].re);if(d)return d.shift(),this.routes[c].handler.apply({},d),this}return this},listen:function(){var a=this,b=a.getFragment(),c=function(){b!==a.getFragment()&&(b=a.getFragment(),a.check(b))};return clearInterval(this.interval),this.interval=setInterval(c,50),this},navigate:function(a){return a=a?a:"","history"===this.mode?history.pushState(null,null,this.root+this.clearSlashes(a)):(window.location.href.match(/#(.*)$/),window.location.href=window.location.href.replace(/#(.*)$/,"")+"#"+a),this}},j={Router:i};e.prototype=e.extend(e.prototype,j)}(this);